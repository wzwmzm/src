<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"> 
	<title>Bootstrap 实例 - 基本表单</title> 
	<script src="./js/jquery-3.4.1.min.js"></script>
	<script src="./js/xlsx.core.min.js"></script>
</head>
<body>
<SCRIPT>
//////与服务器交换数据的例子
 $.ajax({
        type:"POST",
        url:"http://localhost:8101/getusers",
        dataType:"json",
        data:{						//发送给服务器的数据
            message:"吴志伟",
            nick:"wzw",
        },
        success:function(data){		//从服务器收到的数据
            alert("访问成功" + JSON.stringify(data));
            
        //excel文件导出
//        var arr = [
//              {
//                "姓名":"喵喵喵",
//                "年龄":1,
//              },
//              {
//                "姓名":"喵喵",
//                "年龄":2,
//              }
//        ];
			var wopts = {
			  bookType: 'xlsx',
			  bookSST: false,
			  type: 'binary'
			};
			var workBook = {
			  SheetNames: ['Sheet1'],
			  Sheets: {},
			  Props: {}
			};
			//var ws_name = "SheetJS";
			//var workbook;
			workBook.Sheets['Sheet1'] = XLSX.utils.json_to_sheet(data)
			//XLSX.utils.book_append_sheet(workBook, sheet, ws_name);
			XLSX.writeFile(workBook, '资管用户表.xlsx');
		}
 })
</SCRIPT>
</body>
</html>